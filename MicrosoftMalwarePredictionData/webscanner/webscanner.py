#Gets domain name
from tld import get_tld
import socket
import os
import urllib.request
import io

def get_domain_name(url):
    domain_name = get_tid(url)
    return domain_name

def get_domain_name_ip(url):
    ip = socket.gethostbyname(url)
    return ip

def get_nmap(options, ip_address):
    #nmap -options -ip
    nmap_output = ""
    command = "nmap " + options + " " + ip_address
    process = os.popen(command)
    nmap_output = str(process.read())
    #print(results)
    return nmap_output

def get_robots_txt(url):
    if(url.endswith('/')):
        path = url
    else:
        path = url + '/'
    req = urllib.request.urlopen(path + "robots.txt", data = None)
    data = io.TextIOWrapper(req, encoding='utf-8')
    return data.read()

def get_whois(url):
    command = "whois " + url
    process = os.popen(command)
    results = str(process.read())
    return results

def format_nmap_output(nmap_output):
    data = []
    print(type(nmap_output), nmap_output)
    for i in range(len(nmap_output)):
        if (nmap_output[i] == "P" and nmap_output[i+1] == "O"):
            preliminary_result = nmap_output[i+22:]

    individual_data = preliminary_result.splitlines()[:-2]
    for i in individual_data:
        data.append(i.split())
    return data

urls = ["usedvictoria.com","ca-solutions.com.au","hackthebox.eu"]
#a = get_domain_name_ip(urls)
#print(a)
nmap_output = get_nmap('-F',get_domain_name_ip("hackthebox.eu"))
print(format_nmap_output(nmap_output))

#sudo nmap -sP -n 10.0.0.0/24 scanns for devices on the network
